<!DOCTYPE html> 
<html>
    <head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width"/>
        <title>Get Reservation</title>
        <link href="lib/bootstrap/dist/css/bootstrap.css" rel="stylesheet"/>
        <script src="lib/jquery/dist/jquery.js"></script>
    </head>

    <body>
        <div class="container-fluid">
            <h2>Search Reservation <a href="index.html"class="btn btn-sm btn-primary">Back</a></h2>
            <div class="form-group">
                <label for="id">Name: </label>
                <input type="text" class="form-control" id="Name"/>
            </div>
            <div class="text-center panel-body">
                <button id="GetButton" class="btn btn-sm btn-primary">Search</button>
            </div>

            <div id="resultDiv" style="display:none">
                <h2>Product</h2>
                <table class="table table-sm table-striped table-bordered m-2">
                    <thead>
                        <tr>
                            <th>Product ID</th>
                            <th>Product Name</th>
                            <th>Unit Price</th>
                            <th>Unit in Stock</th>
                            <th>Category</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <script type="text/javascript">
            $(document).ready(function () 
            {
                $("#GetButton").click(function (e)
                {
                    console.log($("#Name").val());
                    $("table tbody").html("");
                    $.ajax({
                        url: "http://localhost:5000/api/Product/search?name=" + $("#Name").val(),
                        type: "get",
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (result, status, xhr) 
                        {
                            $("#resultDiv").show();
                            if (typeof result !== 'undefined') 
                            {
                                $.each(result, function (index, value) 
                                {
                                    $("tbody").append($("<tr>"));
                                    appendElement = $("tbody tr").last();
                                    appendElement.append($("<td>").html(value["productId"]));
                                    appendElement.append($("<td>").html(value["productName"]));
                                    appendElement.append($("<td>").html(value["unitPrice"]));
                                    appendElement.append($("<td>").html(value["unitslnStock"]));
                                    appendElement.append($("<td>").html(value["category"]["categoryName"]));
                                });
                            } 
                            
                            else 
                            {
                                $("table tbody").append("<td colspan=\"4\">No Product</td>");
                            }
                        },
                        error: function (xhr, status, error) 
                        {
                            console.log(xhr)
                        }
                    });
                });
            });
        </script>
    </body>
</html>
